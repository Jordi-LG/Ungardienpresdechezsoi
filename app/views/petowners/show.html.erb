<%= render "layouts/flash_success"%>
<%= render "layouts/flash_alert"%>

<section class="p-0 position-relative mt-3 mb-6">
  <div class="d-flex h-100 w-100">
    <div class="row justify-content-around w-100">
      <div class="col-sm-12 col-md-6">
  <ul class="nav nav-tabs tab-line">
    <li class="nav-item"> <a class="nav-link active" data-toggle="tab" href="#tab-3-1"> Profil</a> </li>
    <li class="nav-item"> <a class="nav-link" data-toggle="tab" href="#tab-3-2">Mes animaux</a> </li>
    <% if current_petowner %>
    <li class="nav-item"> <a class="nav-link" data-toggle="tab" href="#tab-3-3"> Mes réservations</a> </li>
    <% end %>
  </ul>
  <div class="tab-content">

    <!-- Profile Part ! -->
    <%= render 'profil' %>

    <!-- Pets Part ! -->
    <%= render 'my_pets' %>

    <!-- Reservations Part ! -->
    <div class="tab-pane" id="tab-3-3">

      <% if current_petowner %>
      <% if current_petowner.id == @petowner.id %>
        <section>
          <div class="container mt-6 pt-4 shadow-lg rounded" style="border:2px solid black">
            <div class="row" >
        				<div class="col-sm-12 col-md-12 ">
        					<ul class="nav nav-tabs tab-with-center-icon justify-content-center nav-justified">
        						<li class="nav-item">
        							<a class="nav-link active" data-toggle="tab" href="#tab-8-1"> <i class="ti-panel"></i> Demandes de réservations </a>
        						</li>
        						<li class="nav-item">
        							<a class="nav-link" data-toggle="tab" href="#tab-8-2"> <i class="ti-palette"></i> Petsittings validé</a>
        						</li>
      							<li class="nav-item">
      								<a class="nav-link" data-toggle="tab" href="#tab-8-3"> <i class="ti-pencil"></i> Petsittings effectués</a>
      							</li>
        					</ul>
        					<div class="tab-content">
                    <%= render 'tab_booking_pending' %>

      						<div class="tab-pane" id="tab-8-2">
                    <div class="col-sm-12 mb-5">
            					<div class="table-responsive-sm">
                        <table class="table table-lg table-noborder table-striped">
                          <thead class="all-text-white bg-grad">
            								<tr class="text-white">
            									<th scope="col">Petsitter</th>
            									<th scope="col">Nom</th>
            									<th scope="col">Prénom</th>
                              <th scope="col">Mail</th>
            									<th scope="col">Réservation</th>
                              <th scope="col"> </th>
            								</tr>
            							</thead>
      										<tbody class="booking">
                            <!-- methode my_petsitters => helper -->
                            <% @bookings_petowner.each do |booking|%>
      												<% if booking.validate_petowner == true %>
                								<tr>
                                  <!-- VERIFICATION SI LE PETSITTERS EXISTE TOUJOURS EN BASE DE DONNÉES -->
                                  <% if petsitter_exists(booking.id) == false %>
                									  <th scope="row"> <%= booking.petsitter_id%> </th>
                  									<td><%= my_petsitters(booking.petsitter_id).first_name%> </td>
                  									<td><%= my_petsitters(booking.petsitter_id).last_name%> </td>
                  									<td><%= my_petsitters(booking.petsitter_id).email%> </td>
                                    <td>Validé le <%= booking.updated_at.strftime("%d-%m-%Y")%></td>
                                    <td>
                                      <%= link_to petsitter_path(booking.petsitter_id) do %>
                                        <span class="btn btn-outline-light text-white">Profile de <%= my_petsitters(booking.petsitter_id).first_name%></span>
                                      <%end%>
      																<span class="btn btn-info text-white">Validé</span>
                                    </td>
                                  <% end %>
                                  <%= form_with(url: petsitting_path(booking.id),local:true, data: { confirm: "Etes-vous sur de vouloir annuler ce rendez-vous ?"}, method: 'delete') do %>
                                    <%= button_tag(type: "submit", class:"btn btn-danger shadow-sm") do %>
                                      <i class="fa fa-trash" aria-hidden="true"></i>
                                    <% end %>
                                  <% end %>
                								</tr>
      												<% end %>
                            <% end %>
            							</tbody>
            						</table>
            					</div>
            				</div>
      						</div>
      					</div>
      				</div>
          </div>
        </section>
        <%else%>
      <% end %>
      <% end %>
    </div>
  </div>
</div>

      <!-- banner image -->
      <div class="col-md-5 d-none d-md-block p-0 ">
          <figure class="w-100 ie-height-900 position-absolute" style="transform: scaleX(-1);margin-left:5%">
            <svg version="1.1" id="Layer_2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 881.8 917.9" style="enable-background:new 0 0 881.8 917.9;" xml:space="preserve">
              <path id="XMLID_6_" fill="url(#BgGradient)" d="M0,39.6c0,0,171-121.5,264,64.5s508.5,178.5,508.5,178.5s240-6-6,228S816,755.1,657,830.1
                s-309,106.5-445.5,76.5C75,876.6,0,717.6,0,717.6V39.6z"/>
                <path id="XMLID_5_" class="fill-dark" d="M0,291.1c0,0,133.5-100.5,169.5,91.5s103.5,204,81,283.5S0,832.6,0,832.6V291.1z"/>
                <g id="XMLID_3_">
                  <defs>
                  <rect id="XMLID_11_" x="175" y="18" width="650" height="850"/>
                  <linearGradient id="BgGradient">
                    <stop class="fill-grad-start" offset="0%"/>
                    <stop class="fill-grad-end" offset="100%"/>
                  </linearGradient>
                  </defs>
                  <clipPath id="XMLID_51_">
                  <use xlink:href="#XMLID_11_"  style="overflow:visible;"/>
                  </clipPath>
                </g>
              </svg>
          </figure>
          <span class="position-relative " style="margin-left:10%">
            <%if @petowner.avatar.attached?%>
              <%= image_tag @petowner.avatar, alt: 'avatar' , class:'shadow-lg', style:'height-max: 560px;width:560px;border-radius:10px;border:2px solid black;'%>
            <%else%>
           <%end%>
         </span>
        </div>
    </div>
  </div>
</section>


<%= render "layouts/button_back_index"%>
